---
title: "disney_originals"
author: "grevend"
date: "13 12 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
```

```{r}
only_keep <- function(row, regex) {
  return(ifelse(!is.na(str_match(row, regex)[,2]), str_match(row, regex)[,2], str_match(row, regex)[,2]))
}

statuses <- c("Renewed", "Pending", "Miniseries", "Awaiting release", "Event", "Development", "Ended", "Film", "Special", "Distribution")
```

## CSV import

```{r}
disney_originals_1 <- read_csv("../datasets/disney/shows/table-1.csv")
disney_originals_1 <- transmute(disney_originals_1,
                                Title = Title,
                                Genre = paste(Genre, " Drama"),
                                Premiere = Premiere,
                                Seasons = Seasons,
                                Runtime = Runtime,
                                Language = NA,
                                Status = Status)

disney_originals_2 <- read_csv("../datasets/disney/shows/table-2.csv")
disney_originals_2 <- transmute(disney_originals_2,
                                Title = Title,
                                Genre = paste(Genre, " Comedy"),
                                Premiere = Premiere,
                                Seasons = Seasons,
                                Runtime = Runtime,
                                Language = NA,
                                Status = Status)

disney_originals <- rbind(disney_originals_1, disney_originals_2)

unique(select(disney_originals, Status))

disney_originals <- transmute(disney_originals, 
                              Title = Title,
                              Genre = Genre,
                              Premiere = Premiere,
                              Seasons = Seasons,
                              Runtime = Runtime,
                              Language = Language,
                              Status = parse_factor(only_keep(Status, "(Renewed|Pending|Miniseries|Awaiting release|Event|Development|Ended|Film|Special|Distribution)"), levels = statuses))

disney_originals
```