---
title: "netflix_originals"
author: "@grevend, @Fynn-Mehrens"
date: "13 12 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
```

```{r}
only_keep <- function(row, regex) {
  return(ifelse(!is.na(str_match(row, regex)[,2]), str_match(row, regex)[,2], str_match(row, regex)[,2]))
}

statuses <- c("Renewed", "Pending", "Miniseries", "Awaiting release")
```

## CSV import

```{r}
#Title, Genre, Premiere, Seasons, Runtime, Status

netflix_originals_1 <- read_csv("../datasets/netflix/table-1.csv")
netflix_originals_1 <- transmute(netflix_originals_1,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = NA,
                                 Status = Status)

netflix_originals_2 <- read_csv("../datasets/netflix/table-2.csv")
netflix_originals_2 <- transmute(netflix_originals_2,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = NA,
                                 Status = Status)

netflix_originals_3 <- read_csv("../datasets/netflix/table-3.csv")
netflix_originals_3 <- transmute(netflix_originals_3,
                                 Title = Title,
                                 Genre = paste(Genre, " Adult Animation"),
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = Language,
                                 Status = Status)

netflix_originals_4 <- read_csv("../datasets/netflix/table-4.csv")
netflix_originals_4 <- transmute(netflix_originals_4,
                                 Title = Title,
                                 Genre = paste(Genre, " Anime"),
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = Language,
                                 Status = Status)

netflix_originals_5 <- read_csv("../datasets/netflix/table-5.csv")
netflix_originals_5 <- transmute(netflix_originals_5,
                                 Title = Title,
                                 Genre = "Children",
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = NA,
                                 Status = Status)

netflix_originals_6 <- read_csv("../datasets/netflix/table-6.csv")
netflix_originals_6 <- transmute(netflix_originals_6,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = "French",
                                 Status = Status)

netflix_originals_7 <- read_csv("../datasets/netflix/table-7.csv")
netflix_originals_7 <- transmute(netflix_originals_7,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = "German",
                                 Status = Status)

netflix_originals_8 <- read_csv("../datasets/netflix/table-8.csv")
netflix_originals_8 <- transmute(netflix_originals_8,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = "Hindi",
                                 Status = Status)

netflix_originals_9 <- read_csv("../datasets/netflix/table-9.csv")
netflix_originals_9 <- transmute(netflix_originals_9,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = "Italian",
                                 Status = Status)

netflix_originals_10 <- read_csv("../datasets/netflix/table-10.csv")
netflix_originals_10 <- transmute(netflix_originals_10,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Japanese",
                                  Status = Status)

netflix_originals_11 <- read_csv("../datasets/netflix/table-11.csv")
netflix_originals_11 <- transmute(netflix_originals_11,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Korean",
                                  Status = Status)

netflix_originals <- rbind(netflix_originals_1, netflix_originals_2)
netflix_originals <- rbind(netflix_originals, netflix_originals_3)
netflix_originals <- rbind(netflix_originals, netflix_originals_4)
netflix_originals <- rbind(netflix_originals, netflix_originals_5)
netflix_originals <- rbind(netflix_originals, netflix_originals_6)
netflix_originals <- rbind(netflix_originals, netflix_originals_7)
netflix_originals <- rbind(netflix_originals, netflix_originals_8)
netflix_originals <- rbind(netflix_originals, netflix_originals_9)
netflix_originals <- rbind(netflix_originals, netflix_originals_10)
netflix_originals <- rbind(netflix_originals, netflix_originals_11)

netflix_originals
```

```{r}
netflix_originals_1 <- read_csv("../datasets/netflix/table-1.csv")

netflix_originals_1 <- transmute(netflix_originals_1, 
                                Title = Title,
                                Genre = Genre,
                                Premiere = Premiere,
                                Seasons = Seasons,
                                Runtime = Runtime,
                                Status = parse_factor(only_keep(Status, "(Renewed|Pending|Miniseries|Awaiting release)"), levels = statuses))

netflix_originals_1
```

```{r}
netflix_originals_1 <- read_csv("../datasets/netflix/table-1.csv")

netflix_originals_1

unique(select(netflix_originals_1, Genre))

netflix_originals_1 <- transmute(netflix_originals_1, 
                                Title = Title,
                                Genre = Genre,
                                Premiere = Premiere,
                                Seasons = Seasons,
                                Runtime = Runtime,
                                Status = parse_factor(only_keep(Status, "(Renewed|Pending|Miniseries|Awaiting release)"), levels = statuses))

netflix_originals_1

unique(select(netflix_originals_1, Genre))
```