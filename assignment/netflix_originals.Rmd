---
title: "netflix_originals"
author: "@grevend, @Fynn-Mehrens"
date: "13 12 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
```

```{r}
only_keep <- function(row, regex) {
  return(ifelse(!is.na(str_match(row, regex)[,2]), str_match(row, regex)[,2], str_match(row, regex)[,2]))
}

statuses <- c("Renewed", "Pending", "Miniseries", "Awaiting release", "Event", "Development")
```

## CSV import

```{r}
#Title, Genre, Premiere, Seasons, Runtime, Status

netflix_originals_1 <- read_csv("../datasets/netflix/table-1.csv")
netflix_originals_1 <- transmute(netflix_originals_1,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = NA,
                                 Status = Status)

netflix_originals_2 <- read_csv("../datasets/netflix/table-2.csv")
netflix_originals_2 <- transmute(netflix_originals_2,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = NA,
                                 Status = Status)

netflix_originals_3 <- read_csv("../datasets/netflix/table-3.csv")
netflix_originals_3 <- transmute(netflix_originals_3,
                                 Title = Title,
                                 Genre = paste(Genre, " Adult Animation"),
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = Language,
                                 Status = Status)

netflix_originals_4 <- read_csv("../datasets/netflix/table-4.csv")
netflix_originals_4 <- transmute(netflix_originals_4,
                                 Title = Title,
                                 Genre = paste(Genre, " Anime"),
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = Language,
                                 Status = Status)

netflix_originals_5 <- read_csv("../datasets/netflix/table-5.csv")
netflix_originals_5 <- transmute(netflix_originals_5,
                                 Title = Title,
                                 Genre = "Children",
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = NA,
                                 Status = Status)

netflix_originals_6 <- read_csv("../datasets/netflix/table-6.csv")
netflix_originals_6 <- transmute(netflix_originals_6,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = "French",
                                 Status = Status)

netflix_originals_7 <- read_csv("../datasets/netflix/table-7.csv")
netflix_originals_7 <- transmute(netflix_originals_7,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = "German",
                                 Status = Status)

netflix_originals_8 <- read_csv("../datasets/netflix/table-8.csv")
netflix_originals_8 <- transmute(netflix_originals_8,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = "Hindi",
                                 Status = Status)

netflix_originals_9 <- read_csv("../datasets/netflix/table-9.csv")
netflix_originals_9 <- transmute(netflix_originals_9,
                                 Title = Title,
                                 Genre = Genre,
                                 Premiere = Premiere,
                                 Seasons = Seasons,
                                 Runtime = Runtime,
                                 Language = "Italian",
                                 Status = Status)

netflix_originals_10 <- read_csv("../datasets/netflix/table-10.csv")
netflix_originals_10 <- transmute(netflix_originals_10,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Japanese",
                                  Status = Status)

netflix_originals_11 <- read_csv("../datasets/netflix/table-11.csv")
netflix_originals_11 <- transmute(netflix_originals_11,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Korean",
                                  Status = Status)

netflix_originals_12 <- read_csv("../datasets/netflix/table-12.csv")
netflix_originals_12 <- transmute(netflix_originals_12,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Mandarin",
                                  Status = Status)

netflix_originals_13 <- read_csv("../datasets/netflix/table-13.csv")
netflix_originals_13 <- transmute(netflix_originals_13,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Norwegian",
                                  Status = Status)


netflix_originals_14 <- read_csv("../datasets/netflix/table-14.csv")
netflix_originals_14 <- transmute(netflix_originals_14,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Portuguese",
                                  Status = Status)

netflix_originals_15 <- read_csv("../datasets/netflix/table-15.csv")
netflix_originals_15 <- transmute(netflix_originals_15,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Spanish",
                                  Status = Status)

netflix_originals_16 <- read_csv("../datasets/netflix/table-16.csv")
netflix_originals_16 <- transmute(netflix_originals_16,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = "Turkish",
                                  Status = Status)

netflix_originals_17 <- read_csv("../datasets/netflix/table-17.csv")
netflix_originals_17 <- transmute(netflix_originals_17,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = Language,
                                  Status = Status)

netflix_originals_18 <- read_csv("../datasets/netflix/table-18.csv")
netflix_originals_18 <- transmute(netflix_originals_18,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = Language,
                                  Status = Status)

netflix_originals_19 <- read_csv("../datasets/netflix/table-19.csv")
netflix_originals_19 <- transmute(netflix_originals_19,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = Language,
                                  Status = Status)

netflix_originals_20 <- read_csv("../datasets/netflix/table-20.csv")
netflix_originals_20 <- transmute(netflix_originals_20,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = Language,
                                  Status = Status)

netflix_originals_21 <- read_csv("../datasets/netflix/table-21.csv")
netflix_originals_21 <- transmute(netflix_originals_21,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = Language,
                                  Status = Status)

netflix_originals_22 <- read_csv("../datasets/netflix/table-22.csv")
netflix_originals_22 <- transmute(netflix_originals_22,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = Seasons,
                                  Runtime = Runtime,
                                  Language = Language,
                                  Status = Status)

netflix_originals_23 <- read_csv("../datasets/netflix/table-23.csv")
netflix_originals_23 <- transmute(netflix_originals_23,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = "1 episode",
                                  Runtime = Runtime,
                                  Language = NA,
                                  Status = "Event")

netflix_originals_24 <- read_csv("../datasets/netflix/table-24.csv")
netflix_originals_24 <- transmute(netflix_originals_24,
                                  Title = Title,
                                  Genre = paste(Genre, " Drama"),
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")

netflix_originals_25 <- read_csv("../datasets/netflix/table-25.csv")
netflix_originals_25 <- transmute(netflix_originals_25,
                                  Title = Title,
                                  Genre = paste(Genre, " Comedy"),
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")

netflix_originals_26 <- read_csv("../datasets/netflix/table-26.csv")
netflix_originals_26 <- transmute(netflix_originals_26,
                                  Title = Title,
                                  Genre = paste(Genre, " Adult Animation"),
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")


netflix_originals_27 <- read_csv("../datasets/netflix/table-27.csv")
netflix_originals_27 <- transmute(netflix_originals_27,
                                  Title = Title,
                                  Genre = paste(Genre, " Anime"),
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")

netflix_originals_28 <- read_csv("../datasets/netflix/table-28.csv")
netflix_originals_28 <- transmute(netflix_originals_28,
                                  Title = Title,
                                  Genre = paste(Genre, " Children"),
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")

netflix_originals_29 <- read_csv("../datasets/netflix/table-29.csv")
netflix_originals_29 <- transmute(netflix_originals_29,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = Language,
                                  Status = "Development")

netflix_originals_30 <- read_csv("../datasets/netflix/table-30.csv")
netflix_originals_30 <- transmute(netflix_originals_30,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")

netflix_originals_31 <- read_csv("../datasets/netflix/table-31.csv")
netflix_originals_31 <- transmute(netflix_originals_31,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = Language,
                                  Status = "Development")

netflix_originals_32 <- read_csv("../datasets/netflix/table-32.csv")
netflix_originals_32 <- transmute(netflix_originals_32,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = Language,
                                  Status = "Development")

netflix_originals_33 <- read_csv("../datasets/netflix/table-33.csv")
netflix_originals_33 <- transmute(netflix_originals_33,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")

netflix_originals_34 <- read_csv("../datasets/netflix/table-34.csv")
netflix_originals_34 <- transmute(netflix_originals_34,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = paste(Seasons, " seasons"),
                                  Runtime = Runtime,
                                  Language = NA,
                                  Status = "Development")

netflix_originals_35 <- read_csv("../datasets/netflix/table-35.csv")
netflix_originals_35 <- transmute(netflix_originals_35,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = Premiere,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")

netflix_originals_36 <- read_csv("../datasets/netflix/table-36.csv")
netflix_originals_36 <- transmute(netflix_originals_36,
                                  Title = Title,
                                  Genre = Genre,
                                  Premiere = NA,
                                  Seasons = NA,
                                  Runtime = NA,
                                  Language = NA,
                                  Status = "Development")

netflix_originals <- rbind(netflix_originals_1, netflix_originals_2)
netflix_originals <- rbind(netflix_originals, netflix_originals_3)
netflix_originals <- rbind(netflix_originals, netflix_originals_4)
netflix_originals <- rbind(netflix_originals, netflix_originals_5)
netflix_originals <- rbind(netflix_originals, netflix_originals_6)
netflix_originals <- rbind(netflix_originals, netflix_originals_7)
netflix_originals <- rbind(netflix_originals, netflix_originals_8)
netflix_originals <- rbind(netflix_originals, netflix_originals_9)
netflix_originals <- rbind(netflix_originals, netflix_originals_10)
netflix_originals <- rbind(netflix_originals, netflix_originals_11)
netflix_originals <- rbind(netflix_originals, netflix_originals_12)
netflix_originals <- rbind(netflix_originals, netflix_originals_13)
netflix_originals <- rbind(netflix_originals, netflix_originals_14)
netflix_originals <- rbind(netflix_originals, netflix_originals_15)
netflix_originals <- rbind(netflix_originals, netflix_originals_16)
netflix_originals <- rbind(netflix_originals, netflix_originals_17)
netflix_originals <- rbind(netflix_originals, netflix_originals_18)
netflix_originals <- rbind(netflix_originals, netflix_originals_19)
netflix_originals <- rbind(netflix_originals, netflix_originals_20)
netflix_originals <- rbind(netflix_originals, netflix_originals_21)
netflix_originals <- rbind(netflix_originals, netflix_originals_22)
netflix_originals <- rbind(netflix_originals, netflix_originals_23)
netflix_originals <- rbind(netflix_originals, netflix_originals_24)
netflix_originals <- rbind(netflix_originals, netflix_originals_25)
netflix_originals <- rbind(netflix_originals, netflix_originals_26)
netflix_originals <- rbind(netflix_originals, netflix_originals_27)
netflix_originals <- rbind(netflix_originals, netflix_originals_28)
netflix_originals <- rbind(netflix_originals, netflix_originals_29)
netflix_originals <- rbind(netflix_originals, netflix_originals_30)
netflix_originals <- rbind(netflix_originals, netflix_originals_31)
netflix_originals <- rbind(netflix_originals, netflix_originals_32)
netflix_originals <- rbind(netflix_originals, netflix_originals_33)
netflix_originals <- rbind(netflix_originals, netflix_originals_34)
netflix_originals <- rbind(netflix_originals, netflix_originals_35)
netflix_originals <- rbind(netflix_originals, netflix_originals_36)

netflix_originals

unique(select(netflix_originals, Status))

netflix_originals <- transmute(netflix_originals, 
                               Title = Title,
                               Genre = Genre,
                               Premiere = Premiere,
                               Seasons = Seasons,
                               Runtime = Runtime,
                               Language = Language,
                               Status = parse_factor(only_keep(Status, "(Renewed|Pending|Miniseries|Awaiting release|Event|Development)"), levels = statuses))

netflix_originals
```